<!DOCTYPE html>
<body>

    <div id="hello-world-app">
        <h1>{{ msg }}</h1>
        <input type="text" v-model="gifInput" placeholder="search for a gif" >
        <button type="button" @click="fetchGif()">get a gif</button>
        <br/>
        <h2>{{ gifUrl }}</h2>
        <img :src="gifUrl" style="display:block; width: 100%; height: 20px;">
    </div>

    <script src="https://unpkg.com/vue@next"></script>
    <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
    <script>
        const app = Vue.createApp(
            {
                data() {
                    return {
                        msg: 'the default msg',
                        gifUrl: 'https://media.giphy.com/media/kd359s4d6VSncbpV9G/giphy.gif',
                        gifInput: '',
                        error: ''
                    }
                },
                methods: {
                    fetchGif() {
                        let self = this;
                        if (!self.input) {
                            self.error = 'provide an input';
                        }
                        axios.get(`/api/gif/${this.gifInput}`)
                            .then(function (response) {
                                // handle success
                                console.log("this.gifUrl before is", self.gifUrl);
                                console.log("response.data is", response.data);
                                self.gifUrl = response.data;
                                console.log("this.gifUrl after is ", self.gifUrl);
                            })
                            .catch(function (error) {
                                // handle error
                                console.log(error);
                                self.error = 'API problem!';
                            });
                    }

                }
            }
        ).mount('#hello-world-app');
    </script>
</body>
